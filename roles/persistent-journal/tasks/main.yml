- name: Create persisent log directory
  ansible.builtin.file:
    state: directory
    path: "{{ journal_directory }}"
    mode: '755'
  notify: Restart systemd-journald

- name: Create persisent log directory
  ansible.builtin.command:
    argv:
      - systemd-tmpfiles
      - --create
      - --prefix
      - "{{ journal_directory }}"

- name: Uninstall rsyslog
  ansible.builtin.apt:
    name: rsyslog
    state: absent
    purge: true
    autoremove: true

- name: Configure journal max size of 1G (larger becomes slow on a Raspberry Pi)
  community.general.ini_file:
    path: /etc/systemd/journald.conf
    section: Journal
    option: SystemMaxUse
    value: 1G
    no_extra_spaces: true
