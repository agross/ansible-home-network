- name: Permanently disable SELinux
  when: >-
    ansible_facts.selinux.status != 'disabled' and
    ansible_facts.virtualization_type != 'lxc'
  ansible.posix.selinux:
    state: permissive
    policy: targeted
    update_kernel_param: true

- name: Install tools also installed on GitHub
  ansible.builtin.package:
    name:
      - jq
      - git
      - python3-pip
      - yq
    state: present

- name: Create runner
  ansible.builtin.import_tasks:
    file: create-runner.yml
  vars:
    instances: "{{ github_runner_instances | ansible.builtin.dict2items }}"
