- name: Linux configuration
  hosts: "{{ playbook_hosts | mandatory }}"
  become: true
  gather_facts: false
  roles:
    - name: guest-agent
      tags: guest-agent
    - name: watchdog
      when: >-
        ansible_virtualization_role == 'guest' or
        "'raspi' in group_names"
      tags: watchdog
    - name: kernel-cmdline
      tags: kernel-cmdline
    - name: fstrim
      tags: fstrim
    - name: filesystem
      tags: filesystem
    - name: devsec.hardening.ssh_hardening
      tags: ssh
    - name: networking
      when: systemd_networkd_network is defined
      tags: [network, networking]
    - name: postfix
      when: google_smtp_password is defined
      tags: postfix
    - name: unit-status-mail
      when: google_smtp_password is defined
      tags: unit-status-mail
    - name: borgmatic
      when: borgmatic_encryption_passphrase is defined
      tags: borgmatic
    - name: netdata
      tags: netdata
    - name: dotfiles
      tags: dotfiles
