- name: Raspberry Pi configuration
  hosts: home:&raspi
  become: true
  gather_facts: false
  roles:
    - name: raspi-config
      tags: raspi-config
    - name: fstrim
      tags: fstrim
    - name: smartmontools
      tags: smartmontools
    - name: persistent-journal
      tags: persistent-journal
    - name: swapfile
      tags: swapfile
    - name: led-heartbeat
      tags: led-heartbeat
    - name: argon-one
      tags: argon-one

- name: Import Linux configuration playbook
  ansible.builtin.import_playbook: _linux.yml
  vars:
    playbook_hosts: home:&linux

- name: Import Fedora configuration playbook
  ansible.builtin.import_playbook: _fedora.yml
  vars:
    playbook_hosts: home:&fedora

- name: Import gateway configuration playbook
  ansible.builtin.import_playbook: _gateway.yml
  vars:
    playbook_hosts: gateway-home

- name: Home automation
  hosts: pi
  become: true
  gather_facts: false
  roles:
    - name: docker
      tags: docker
    - name: mqtt
      tags:
        - mqtt
        - container
    - name: iobroker
      tags:
        - iobroker
        - container
    - name: logger
      tags:
        - logger
        - container

- name: Hosted services
  hosts: router
  become: true
  gather_facts: false
  roles:
    - name: dns-server
      tags:
        - dns-server
        - container
    - name: vaultwarden
      tags:
        - vaultwarden
        - container
    - name: photoprism
      tags:
        - photoprism
        - container
    - name: harbor
      tags:
        - harbor
        - container
    - name: nextcloud
      tags:
        - nextcloud
        - container
